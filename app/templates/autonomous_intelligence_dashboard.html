<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ¤– Autonomous Intelligence Dashboard - ChatterFix AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .ai-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
        }
        
        .prediction-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .orchestrator-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .data-engine-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .status-active { background-color: #28a745; }
        .status-warning { background-color: #ffc107; }
        .status-error { background-color: #dc3545; }
        
        .ai-model-badge {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin: 2px;
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }
        
        .real-time-indicator {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .equipment-card {
            border-left: 4px solid #667eea;
            transition: transform 0.2s;
        }
        
        .equipment-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .insight-card {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="ai-card text-center">
                    <h1><i class="fas fa-robot"></i> Autonomous Intelligence Dashboard</h1>
                    <p class="lead mb-0">Multi-AI Coordinated Predictive Maintenance Intelligence System</p>
                    <small>ðŸ”„ Real-time updates â€¢ ðŸ¤– 6 AI Models Active â€¢ ðŸŽ¯ Autonomous Decision Making</small>
                </div>
            </div>
        </div>
        
        <!-- AI System Status Overview -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="status-indicator status-active real-time-indicator"></div>
                        <span>AI Team Status</span>
                        <div class="metric-value">ACTIVE</div>
                        <small class="text-muted">6 models coordinating</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="fas fa-chart-line text-success fa-2x mb-2"></i>
                        <div class="metric-value">{{ (orchestrator_status.performance_metrics.consensus_accuracy * 100) | round(1) }}%</div>
                        <small class="text-muted">Consensus Accuracy</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="fas fa-brain text-info fa-2x mb-2"></i>
                        <div class="metric-value">{{ prediction_status.system_health.total_predictions }}</div>
                        <small class="text-muted">AI Predictions Made</small>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <i class="fas fa-shield-alt text-warning fa-2x mb-2"></i>
                        <div class="metric-value">{{ engine_status.system_health.anomalies_detected }}</div>
                        <small class="text-muted">Anomalies Detected</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Services Status -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="prediction-card">
                    <h5><i class="fas fa-crystal-ball"></i> Predictive Hub</h5>
                    <p class="mb-1">Multi-AI Equipment Analysis</p>
                    <div class="mt-2">
                        <span class="ai-model-badge">Claude</span>
                        <span class="ai-model-badge">ChatGPT</span>
                        <span class="ai-model-badge">Gemini</span>
                        <span class="ai-model-badge">Grok</span>
                    </div>
                    <small>âœ… {{ hub_data.system_status.predictions_made }} predictions completed</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="orchestrator-card">
                    <h5><i class="fas fa-sitemap"></i> AI Orchestrator</h5>
                    <p class="mb-1">Multi-Model Coordination</p>
                    <small>âœ… {{ orchestrator_status.system_status.total_models }} models managed<br>
                    ðŸŽ¯ {{ orchestrator_status.system_status.completed_tasks }} tasks completed</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="data-engine-card">
                    <h5><i class="fas fa-database"></i> Data Engine</h5>
                    <p class="mb-1">Autonomous Data Analysis</p>
                    <small>ðŸ“¡ {{ engine_status.system_health.data_points_processed }} data points<br>
                    âš¡ {{ engine_status.system_health.average_processing_latency_ms | round(1) }}ms latency</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); color: white; border-radius: 12px;">
                    <div class="card-body">
                        <h5><i class="fas fa-cogs"></i> ML Engine</h5>
                        <p class="mb-1">Intelligent Predictions</p>
                        <small>ðŸŽ¯ {{ prediction_status.system_health.success_rate | round(1) }}% success rate<br>
                        ðŸ§  {{ prediction_status.model_performance | length }} ML models active</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Real-time Equipment Monitoring -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0"><i class="fas fa-industry"></i> Real-time Equipment Intelligence</h5>
                    </div>
                    <div class="card-body">
                        <div class="row" id="equipment-grid">
                            {% for equipment in sample_equipment[:3] %}
                            <div class="col-md-4">
                                <div class="equipment-card card border-0 shadow-sm mb-3">
                                    <div class="card-body">
                                        <h6>{{ equipment.name }}</h6>
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span class="badge {% if equipment.health_score > 85 %}bg-success{% elif equipment.health_score > 70 %}bg-warning{% else %}bg-danger{% endif %}">
                                                {{ equipment.health_score }}% Health
                                            </span>
                                            <span class="text-muted">{{ equipment.location }}</span>
                                        </div>
                                        <div class="row text-center">
                                            <div class="col-4">
                                                <small class="text-muted">Temp</small><br>
                                                <strong>{{ equipment.temperature | round(1) }}Â°C</strong>
                                            </div>
                                            <div class="col-4">
                                                <small class="text-muted">Vibration</small><br>
                                                <strong>{{ equipment.vibration_level | round(1) }}</strong>
                                            </div>
                                            <div class="col-4">
                                                <small class="text-muted">Efficiency</small><br>
                                                <strong>{{ equipment.efficiency_rating | round(1) }}%</strong>
                                            </div>
                                        </div>
                                        <button class="btn btn-outline-primary btn-sm mt-2 w-100" onclick="analyzeEquipment('{{ equipment.id }}')">
                                            <i class="fas fa-brain"></i> AI Analysis
                                        </button>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Coordination Demo -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0"><i class="fas fa-users"></i> Multi-AI Coordination Demo</h5>
                    </div>
                    <div class="card-body">
                        <p>Demonstrate AI team coordination for complex analysis:</p>
                        <div class="mb-3">
                            <label class="form-label">Task Type:</label>
                            <select class="form-select" id="ai-task-type">
                                <option value="analysis">Equipment Analysis</option>
                                <option value="prediction">Failure Prediction</option>
                                <option value="optimization">Performance Optimization</option>
                                <option value="troubleshooting">Issue Troubleshooting</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Priority Level:</label>
                            <select class="form-select" id="ai-priority">
                                <option value="MEDIUM">Medium</option>
                                <option value="HIGH">High</option>
                                <option value="CRITICAL">Critical</option>
                            </select>
                        </div>
                        <button class="btn btn-success" onclick="executeAITask()">
                            <i class="fas fa-rocket"></i> Execute AI Team Task
                        </button>
                        <div id="ai-task-results" class="mt-3"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-info text-white">
                        <h5 class="mb-0"><i class="fas fa-chart-area"></i> Autonomous Insights</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-info mb-3" onclick="generateInsights()">
                            <i class="fas fa-lightbulb"></i> Generate AI Insights
                        </button>
                        <div id="autonomous-insights">
                            <div class="insight-card">
                                <h6><i class="fas fa-trending-up"></i> Predictive Maintenance</h6>
                                <p class="mb-1">AI analysis identifies 23% reduction in unplanned downtime</p>
                                <small>Confidence: 89% â€¢ Impact: High</small>
                            </div>
                            <div class="insight-card">
                                <h6><i class="fas fa-dollar-sign"></i> Cost Optimization</h6>
                                <p class="mb-1">Multi-AI coordination enables 15% cost savings</p>
                                <small>Confidence: 85% â€¢ Impact: Medium</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Real-time Performance Charts -->
        <div class="row">
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-header">
                        <h6 class="mb-0">AI Performance Metrics</h6>
                    </div>
                    <div class="card-body">
                        <canvas id="performance-chart" height="200"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-header">
                        <h6 class="mb-0">Prediction Accuracy Trends</h6>
                    </div>
                    <div class="card-body">
                        <canvas id="accuracy-chart" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Auto-refresh status every 30 seconds
        setInterval(updateRealTimeStatus, 30000);
        
        // Initialize charts
        initializeCharts();
        
        function updateRealTimeStatus() {
            fetch('/autonomous-intelligence/real-time-status')
                .then(response => response.json())
                .then(data => {
                    console.log('Status updated:', data);
                    // Update status indicators
                })
                .catch(error => console.error('Status update error:', error));
        }
        
        async function executeAITask() {
            const taskType = document.getElementById('ai-task-type').value;
            const priority = document.getElementById('ai-priority').value;
            const resultsDiv = document.getElementById('ai-task-results');
            
            resultsDiv.innerHTML = `
                <div class="text-center">
                    <div class="spinner-border spinner-border-sm" role="status"></div>
                    <p class="mt-2">Coordinating AI team...</p>
                </div>
            `;
            
            try {
                const response = await fetch('/autonomous-intelligence/execute-ai-task', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        task_type: taskType,
                        priority: priority,
                        context: {equipment_type: "hydraulic_pump", urgency: priority}
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    resultsDiv.innerHTML = `
                        <div class="alert alert-success">
                            <h6><i class="fas fa-check-circle"></i> AI Task Completed</h6>
                            <p><strong>Consensus:</strong> ${result.consensus_result.final_recommendation}</p>
                            <p><strong>Models Involved:</strong> ${result.consensus_result.participating_models.join(', ')}</p>
                            <p><strong>Confidence:</strong> ${(result.consensus_result.consensus_confidence * 100).toFixed(1)}%</p>
                        </div>
                    `;
                } else {
                    resultsDiv.innerHTML = `<div class="alert alert-warning">Task failed: ${result.error}</div>`;
                }
            } catch (error) {
                resultsDiv.innerHTML = `<div class="alert alert-danger">Error: ${error.message}</div>`;
            }
        }
        
        async function analyzeEquipment(equipmentId) {
            const equipment = {{ sample_equipment | tojson }}.find(eq => eq.id === equipmentId);
            
            try {
                const response = await fetch('/autonomous-intelligence/predict-equipment-failure', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(equipment)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert(`AI Analysis for ${equipmentId}:\n\nFailure Probability: ${(result.ai_team_analysis.failure_probability * 100).toFixed(1)}%\nRisk Level: ${result.ai_team_analysis.risk_level}\nConfidence: ${(result.ai_team_analysis.confidence_score * 100).toFixed(1)}%`);
                }
            } catch (error) {
                alert('Analysis failed: ' + error.message);
            }
        }
        
        async function generateInsights() {
            const insightsDiv = document.getElementById('autonomous-insights');
            
            insightsDiv.innerHTML = '<div class="text-center"><div class="spinner-border" role="status"></div><p>Generating insights...</p></div>';
            
            try {
                const response = await fetch('/autonomous-intelligence/generate-insights', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({analysis_type: "comprehensive", timeframe: "current"})
                });
                
                const result = await response.json();
                
                if (result.success) {
                    const insights = result.autonomous_insights.map(insight => `
                        <div class="insight-card">
                            <h6><i class="fas fa-lightbulb"></i> ${insight.category}</h6>
                            <p class="mb-1">${insight.insight}</p>
                            <small>Confidence: ${(insight.confidence * 100).toFixed(0)}% â€¢ Impact: ${insight.impact}</small>
                        </div>
                    `).join('');
                    
                    insightsDiv.innerHTML = insights;
                }
            } catch (error) {
                insightsDiv.innerHTML = '<div class="alert alert-warning">Insights generation failed</div>';
            }
        }
        
        function initializeCharts() {
            // Performance metrics chart
            const perfCtx = document.getElementById('performance-chart').getContext('2d');
            new Chart(perfCtx, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                    datasets: [{
                        label: 'AI Accuracy',
                        data: [85, 87, 89, 91, 88, 90],
                        borderColor: '#667eea',
                        tension: 0.4
                    }, {
                        label: 'Prediction Success',
                        data: [82, 85, 88, 89, 87, 91],
                        borderColor: '#764ba2',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 75,
                            max: 95
                        }
                    }
                }
            });
            
            // Accuracy trends chart
            const accCtx = document.getElementById('accuracy-chart').getContext('2d');
            new Chart(accCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Claude', 'ChatGPT', 'Gemini', 'Grok'],
                    datasets: [{
                        data: [95, 92, 90, 88],
                        backgroundColor: ['#667eea', '#764ba2', '#f093fb', '#4facfe']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>