{
  "project_name": "ChatterFix Enterprise Database & Analytics",
  "primary_database": {
    "technology": "PostgreSQL 15+ with Enterprise Extensions",
    "configuration": {
      "version": "PostgreSQL 15.4",
      "extensions": [
        "TimescaleDB - Time-series data for IoT sensors",
        "PostGIS - Geospatial data for asset locations",
        "pg_stat_statements - Query performance monitoring",
        "uuid-ossp - UUID generation",
        "pgcrypto - Advanced encryption functions"
      ],
      "performance_tuning": {
        "shared_buffers": "25% of RAM",
        "effective_cache_size": "75% of RAM",
        "work_mem": "256MB per connection",
        "max_connections": "200",
        "checkpoint_segments": "32"
      }
    }
  },
  "multi_tenancy": {
    "strategy": "Shared database with row-level security",
    "implementation": {
      "tenant_isolation": "tenant_id column + RLS policies",
      "data_partitioning": "Partition large tables by tenant_id",
      "schema_isolation": "Separate schemas for tenant-specific customizations",
      "connection_pooling": "Per-tenant connection pools"
    },
    "security": {
      "row_level_security": "Enabled on all multi-tenant tables",
      "tenant_context": "SET app.current_tenant_id for session",
      "data_encryption": "Column-level encryption for PII",
      "audit_logging": "Complete data access audit trail"
    }
  },
  "data_architecture": {
    "core_entities": {
      "tenants": {
        "purpose": "Multi-tenant organization management",
        "key_fields": [
          "id",
          "name",
          "domain",
          "settings",
          "subscription_tier"
        ]
      },
      "users": {
        "purpose": "User management with RBAC",
        "key_fields": [
          "id",
          "tenant_id",
          "username",
          "email",
          "roles",
          "permissions"
        ]
      },
      "work_orders": {
        "purpose": "Core CMMS work order management",
        "key_fields": [
          "id",
          "tenant_id",
          "title",
          "description",
          "status",
          "priority",
          "assigned_to"
        ],
        "partitioning": "Range partition by created_at (monthly)"
      },
      "assets": {
        "purpose": "Equipment and asset management",
        "key_fields": [
          "id",
          "tenant_id",
          "name",
          "type",
          "location",
          "parent_asset_id"
        ],
        "special_features": [
          "Hierarchical structure",
          "Geospatial location data"
        ]
      },
      "parts": {
        "purpose": "Inventory and parts management",
        "key_fields": [
          "id",
          "tenant_id",
          "part_number",
          "description",
          "quantity",
          "cost"
        ],
        "inventory_tracking": "Real-time stock levels with reorder points"
      },
      "maintenance_schedules": {
        "purpose": "Preventive maintenance planning",
        "key_fields": [
          "id",
          "tenant_id",
          "asset_id",
          "schedule_type",
          "frequency",
          "next_due"
        ],
        "automation": "Auto-generate work orders based on schedules"
      }
    },
    "analytics_entities": {
      "sensor_data": {
        "technology": "TimescaleDB hypertable",
        "purpose": "IoT sensor data collection",
        "key_fields": [
          "timestamp",
          "sensor_id",
          "asset_id",
          "metric_type",
          "value"
        ],
        "retention": "Raw data 1 year, aggregated data 7 years"
      },
      "performance_metrics": {
        "purpose": "KPI and performance tracking",
        "metrics": [
          "MTTR (Mean Time To Repair)",
          "MTBF (Mean Time Between Failures)",
          "Asset availability percentage",
          "Work order completion rates",
          "Maintenance cost per asset"
        ]
      }
    }
  },
  "analytics_layer": {
    "real_time_analytics": {
      "technology": "PostgreSQL + TimescaleDB + Redis",
      "capabilities": [
        "Live dashboard updates",
        "Real-time KPI calculations",
        "Instant alert generation",
        "Streaming data processing"
      ]
    },
    "batch_analytics": {
      "technology": "Apache Airflow + dbt",
      "scheduled_jobs": [
        "Daily KPI calculations",
        "Weekly performance reports",
        "Monthly cost analysis",
        "Quarterly trend analysis"
      ]
    },
    "data_warehouse": {
      "approach": "Dimensional modeling within PostgreSQL",
      "fact_tables": [
        "fact_work_orders - Work order events",
        "fact_asset_performance - Asset metrics over time",
        "fact_inventory_transactions - Parts usage tracking"
      ],
      "dimension_tables": [
        "dim_time - Date/time dimensions",
        "dim_assets - Asset hierarchy",
        "dim_users - User and technician info"
      ]
    }
  },
  "performance_optimization": {
    "indexing_strategy": {
      "primary_indexes": "All primary keys and foreign keys",
      "composite_indexes": "tenant_id + frequently queried columns",
      "partial_indexes": "For status-based queries with conditions",
      "gin_indexes": "For JSONB configuration data"
    },
    "query_optimization": {
      "materialized_views": "For complex analytical queries",
      "query_planner": "Regular ANALYZE and query plan optimization",
      "connection_pooling": "PgBouncer for connection management"
    },
    "caching_strategy": {
      "redis_cache": "Session data and frequently accessed lookups",
      "application_cache": "Query result caching in FastAPI",
      "cdn_caching": "Static data and reports"
    }
  },
  "backup_and_recovery": {
    "backup_strategy": {
      "continuous_backup": "WAL-E with S3 storage",
      "full_backups": "Daily full database backups",
      "incremental_backups": "15-minute WAL archiving",
      "cross_region": "Backups replicated to multiple regions"
    },
    "disaster_recovery": {
      "rpo_target": "15 minutes (Recovery Point Objective)",
      "rto_target": "4 hours (Recovery Time Objective)",
      "failover_strategy": "Automated failover to hot standby",
      "testing": "Monthly DR drills and recovery testing"
    }
  },
  "monitoring_and_observability": {
    "database_monitoring": {
      "tools": [
        "PostgreSQL native stats",
        "pg_stat_statements",
        "pgBadger"
      ],
      "metrics": [
        "Query performance and slow queries",
        "Connection counts and wait events",
        "Disk usage and I/O statistics",
        "Replication lag and health"
      ]
    },
    "application_monitoring": {
      "query_tracking": "All database interactions logged",
      "performance_alerts": "Automated alerts for slow queries",
      "capacity_planning": "Growth trend analysis"
    }
  },
  "compliance_and_governance": {
    "data_governance": {
      "data_classification": "Automatic PII detection and classification",
      "retention_policies": "Automated data archival based on policies",
      "data_lineage": "Track data flow from source to analytics"
    },
    "compliance_features": {
      "gdpr_compliance": "Right to be forgotten implementation",
      "audit_logging": "Complete audit trail for compliance",
      "encryption": "Column-level encryption for sensitive data",
      "access_controls": "Fine-grained permission system"
    }
  }
}